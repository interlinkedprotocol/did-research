@startuml

title Step #6: Claim signing - event handling

autonumber

ClaimSigningHandler_Lambda -> SQS : Create queue 
ClaimSigningHandler_Lambda -> SQS : Subscribe queue to SNS topic for CLAIM SIGNING EVENTS
SQS -> ClaimSigningHandler_Lambda : Incoming events that was published to SNS topic CLAIM SIGNING EVENTS
ClaimSigningHandler_Lambda -> DynamoDB : Request operation details by operation id from event
DynamoDB -> ClaimSigningHandler_Lambda : Response with operation details
ClaimSigningHandler_Lambda -> ClaimSigningHandler_Lambda : Throw if Status !== 2
ClaimSigningHandler_Lambda -> ClaimSigningHandler_Lambda : Sign raw claims with private key (HOW DO WE GETTING IT ?)
ClaimSigningHandler_Lambda -> ClaimSigningHandler_Lambda : Building did-jwt (DO WE NEED THIS ?)
ClaimSigningHandler_Lambda -> DynamoDB : Update operation details (did-jwt , Status=3)

@enduml
