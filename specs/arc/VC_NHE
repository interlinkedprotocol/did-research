@startuml

title VC NHE

autonumber
actor Holder

TensorFlowAgent -> InterlinkedProtocolAgent : requestIdentity()
InterlinkedProtocolAgent -> InterlinkedProtocolAgent : generate Mnemonic
InterlinkedProtocolAgent -> InterlinkedProtocolAgent : generate HD Wallet (master node)
InterlinkedProtocolAgent -> TensorFlowAgent : { Mnemonic }
TensorFlowAgent -> TensorFlowAgent : stores mnemonic and index_of_last_used_wallet=null

WebApp -> WebApp : encode image to base64
WebApp -> TensorFlowAgent : send encoded image
TensorFlowAgent -> TensorFlowAgent : run image through TF algorithm and collect claims
TensorFlowAgent -> InterlinkedProtocolAgent : request one-time wallet for claim signing { Mnemonic, index }
InterlinkedProtocolAgent -> InterlinkedProtocolAgent : derive one-time wallet for Mnemonic and index+1
InterlinkedProtocolAgent -> TensorFlowAgent : { privateKey, publicKey }
TensorFlowAgent -> TensorFlowAgent : sign claims with privateKey
TensorFlowAgent -> WebApp : send verifiable claim

WebApp -> TensorFlowAgent : request TensorFlowAgent's publicKey
TensorFlowAgent -> InterlinkedProtocolAgent : request one-time wallet for publicKey key sharing { Mnemonic, index }
InterlinkedProtocolAgent -> InterlinkedProtocolAgent : derive one-time wallet for Mnemonic and index+1
InterlinkedProtocolAgent -> TensorFlowAgent : { publicKey }
TensorFlowAgent -> WebApp : { publicKey }

@enduml